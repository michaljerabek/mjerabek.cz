!function(l){!function(){for(var r=0,t=["ms","moz","webkit","o"],e=0;e<t.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[t[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[e]+"CancelAnimationFrame"]||window[t[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,e){var i=(new Date).getTime(),s=Math.max(0,16-(i-r)),n=window.setTimeout(function(){t(i+s)},s);return r=i+s,n}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}();var t,i,s,e,d=(i=document.createElement("div"),s="transform",["","o","ms","moz","webkit"].some(function(t){var e=t?t+"Transform":"transform";if(void 0!==i.style[e])return s=e,t?"-"+t+"-":"",!0}),s),c=((t=document.createElement("div")).style[d]="translate3d(0,0,0)",!!t.style[d]),u="transition",f=function(){for(var t=document.createElement("div"),e=["transition","transitionend","","OTransition","otransitionend","-o-","MozTransition","transitionend","-moz-","WebkitTransition","webkitTransitionEnd","-webkit-"],i=0,s=e.length;i<s;i+=3)if(void 0!==t.style[e[i]])return u=e[i],e[i+2],e[i+1];return null}(),n={value:[],is3d:!1},m=function(t){var e,i=(e="none"!==(e=getComputedStyle(t[0])[d])&&e?e:"matrix(1, 0, 0, 1, 0, 0)",n.value=e.replace(/^.*\((.*)\)$/g,"$1").split(/, +/),n.is3d=-1!==e.indexOf("3d"),n);return{x:i.is3d?+i.value[12]:+i.value[4],y:i.is3d?+i.value[13]:+i.value[5]}},r=function(t,e,i){i=i||0;var s="client"+e.toUpperCase();return"number"==typeof(t=t.originalEvent||t)[s]?t[s]:t.touches[i]?t.touches[i][s]:0},g=function(t){return(t instanceof HTMLElement?t:t[0]).getBoundingClientRect()},T=(e=l([null]),function(t){return e[0]=t,e}),o=l(window),a="Infinitum",p={self:"infinitum",disabled:"infinitum--disabled",start:"infinitum--start",end:"infinitum--end",center:"infinitum--center",debug:"infinitum--debug",item:"infinitum__item",current:"infinitum__item--current",possibleCurrent:"infinitum__item--possible-current",hide:"infinitum__item--hide",toEnd:"infinitum__item--to-end",toStart:"infinitum__item--to-start",track:"infinitum__track",dragging:"infinitum__track--dragging",moving:"infinitum__track--moving",speed0:"infinitum__track--static",speed1:"infinitum__track--slow",speed2:"infinitum__track--medium",speed3:"infinitum__track--fast",selector:function(t,e){return(e?":not(":"")+"."+this[t]+(e?")":"")}},E="willLeft",_="willTranslate",I="translate",S="offset",v="fakeTransitionTimeout",h="infinitum-url",C={START:"start",END:"end",CENTER:"center"},R={CLOSEST:"closest",STILL_INSIDE:"still-inside",FULL:"full"},N={selector:p.selector("self"),el:null,trackSelector:null,itemSelector:null,reverseItems:!1,mode:C.START,wheelKeysTapSetCurrent:!0,fade:!0,currentIn:R.CLOSEST,currentOut:R.STILL_INSIDE,clearEdge:!0,breakAll:!1,startBreak:C.CENTER,endBreak:C.END,breakOnEdge:!1,balanced:!1,refreshItems:!0,keyThrottle:75,wheelThrottle:40,watchContainer:0,watchItems:0,debug:!1};l.easing["easeOutQuad."+a]=function(t){return 1-(1-t)*(1-t)};var $=[],k=[],b=1,y=null,w=!0,O=window.Infinitum=function(t){this.id=a+b++,this.NS="."+this.id,this.initialized=!1,this._hasPointer=!1,this._shouldCancelRAF=!0,this._lastTrackX=0,this._lastFadeSpeed=-1,this.startItemPosWill=0,this.endItemPosWill=0,this.$willStartItem=null,this.$willEndItem=null,this.$leftItemsOver=null,this.$rightItemsOver=null,this.$insideItems=null,this.init(t)};O.CLASS=p,O.EVENT={tap:"tap",key:"key",scroll:"scroll",dragging:"dragging",dragend:"dragend",change:"change",possibleChange:"possiblechange"},O.DIR={LEFT:1,RIGHT:2},O.DEFAULTS=N,O.POSITION=C,O.CURRENT=R,O.FAKE_TRANSITION_TIMEOUT=700,O.CAPTURE_WHEEL_TIMEOUT=375,O.prototype.init=function(t,e){if(this.initialized){if(!e)return;this.destroy()}k.push(this),this._animate=this._animate.bind(this),this._initOptions(t),this._lastDir=this.options.mode===C.END?O.DIR.RIGHT:O.DIR.LEFT,this._prepareSelf(),this._prepareTrack(),this._prepareItems(),this._initEvents(),this.initialized=!0,this.options.debug&&this.$self.addClass(p.debug)},O.prototype.destroy=function(){if(this.initialized){k.splice(k.indexOf(this),1),this._shouldCancelRAF=!0,this._forceCancelRAF=!0,cancelAnimationFrame(this._lastRAF),this._destroyEvents(),this.$self.removeAttr("data-"+h).removeClass(p.self).removeClass(p.disabled).removeClass(this.options.mode===C.START?p.start:this.options.mode===C.END?p.end:p.center).removeClass(p.debug);var t={textIndent:""};t[d]="",t[u+"Duration"]="",this.$track.stop(!0,!0).css(t).off(this.NS,"").removeClass(p.track).removeClass(p.dragging).removeClass(p.moving).removeClass(p.speed0).removeClass(p.speed1).removeClass(p.speed2).removeClass(p.speed3).removeData([_+this.NS,v+this.NS]),this._trackXShouldBe=0,this.$items.each(function(t,e){var i=T(e);clearTimeout(i.data(v+this.NS)),i.removeData([v+this.NS,E+this.NS,S+this.NS,I+this.NS])}.bind(this));var e={};e[d]="",this.options.reverseItems&&this._reverseItems(),this.$items.css(e).off(this.NS).removeClass(p.item).removeClass(p.current).removeClass(p.possibleCurrent).removeClass(p.toEnd).removeClass(p.toStart).removeClass(p.hide),this.$self=this.$track=this.$items=this.$currentItem=this.$leftItemsOver=this.$rightItemsOver=this.$insideItems=this._$possibleCurrent=this.$willStartItem=this.$willEndItem=null,this.initialized=!1}},O.prototype.refresh=function(t,e){this.destroy(),this.init(e?l.extend({},this.options,t):t)},O.prototype.softRefresh=function(t){this.refreshing=!0,this._generateSelfRect(),(this.options.refreshItems&&!1!==t||t)&&(this._prepareItems(!0),this._fakeMove(!1)),this.refreshing=!1},O.prototype.setCurrent=function(t,e){if(this._generateSelfRect(),"number"==typeof t?t=this.$items.eq(t):"string"==typeof t&&(t=this.$items.filter(t)),this._setCurrent(t,!1,!1,!1,e),e){var i=this.options.fade;this.options.fade=!1,this._move(this._lastDir===O.DIR.LEFT?-1:1,!1,!0),this.options.fade=i}},O.prototype.on=function(t,e){this.$self.on(t,e)},O.prototype.off=function(t){this.$self.off(t)},O.prototype.disable=function(){this.$self.addClass(p.disabled),this.disabled=!0},O.prototype.enable=function(){this.$self.removeClass(p.disabled),this.disabled=!1},O.prototype.findNext=function(t){var e=(t=t||this.$currentItem).next();return e.length||(e=this.$items.first()),e},O.prototype.findPrev=function(t){var e=(t=t||this.$currentItem).prev();return e.length||(e=this.$items.last()),e},O.prototype.next=function(){this._lastDir=O.DIR.LEFT,this._setCurrent(this.findNext(),!1,!0)},O.prototype.prev=function(){this._lastDir=O.DIR.RIGHT,this._setCurrent(this.findPrev(),!1,!0)},O.prototype.dragging=function(){return!1!==this._hasPointer},O.prototype._initOptions=function(t){"string"==typeof t&&(t={selector:t}),t&&(t.jquery||t instanceof HTMLElement)&&(t={el:t}),(t=t||this.options||{}).mode===C.CENTER&&(t.currentOut=t.currentIn);var e=null;!1===t.fade&&((e=l.extend({},N)).startBreak=O.POSITION.END,e.endBreak=O.POSITION.START),t.mode===C.CENTER&&((e=e||l.extend({},N)).startBreak=O.POSITION.END,e.endBreak=O.POSITION.START,e.currentIn=O.CURRENT.CLOSEST,e.currentOut=O.CURRENT.CLOSEST,e.clearEdge=!1,e.balanced=!0),t.mode===C.END&&!1!==t.fade&&((e=e||l.extend({},N)).startBreak=C.END,e.endBreak=C.CENTER),this.options=l.extend({},e||N,this.options===t?{}:this.options,t),f||(this.options.fade=!1)},O.prototype._prepareSelf=function(){this.$self=this.options.el&&this.options.el.jquery?this.options.el:l(this.options.el instanceof HTMLElement?this.options.el:this.options.selector),this.$self.attr("tabindex",0).attr("data-"+h,"https://github.com/michaljerabek/infinitum").addClass(this.options.mode===C.START?p.start:this.options.mode===C.END?p.end:p.center).addClass(p.self),this._generateSelfRect()},O.prototype._generateSelfRect=function(t){this._origSelfRect=g(this.$self);var e=this.$self.css(["padding-left","padding-right","border-left-width","border-right-width"]),i={};if(i.left=this._origSelfRect.left+parseFloat(e["padding-left"])+parseFloat(e["border-left-width"]),i.right=this._origSelfRect.right-parseFloat(e["padding-right"])-parseFloat(e["border-right-width"]),i.center=this._origSelfRect.left+(this._origSelfRect.right-this._origSelfRect.left)/2,i.width=this._origSelfRect.width,i.height=this._origSelfRect.height,t)return i;this._selfRect=i},O.prototype._prepareTrack=function(){this.$track=this.options.trackSelector?l(this.options.trackSelector):this.$self.children().first(),this.$track.addClass(p.track),this._speed=[7,7,7,7,7],this._setTrackPosition(0,!1),this._trackXShouldBe=0},O.prototype._reverseItems=function(){var i=this.$items.first().parent();this.$items=l(this.$items.get().reverse()).each(function(t,e){i.append(e)}.bind(this))},O.prototype._prepareItems=function(t){t||(this.$currentItem=l()),this.$items=this.options.itemSelector?this.$track.find(this.options.itemSelector):this.$track.children(),this.$items.addClass(p.item),!this.initialized&&this.options.reverseItems&&this._reverseItems();var r=0,o=0,a=this;if(this.$items.each(function(t,e){var i=T(e),s={},n={};s[d]=c?"translate3d(0px, 0px, 0px)":"translateX(0px)",i.css(s),n[I+a.NS]=0,n[S+a.NS]=r,n[E+a.NS]=r,i.data(n),r+=i.outerWidth(),o=r}),this.options.watchItems&&(this._lastSizes=this.$items.get().map(function(t){return g(t)})),this._sortItems(),t)return this._moveToItem(this.$currentItem,!1,!1,!0),void(this._$possibleCurrent=this.$currentItem);this._initCurrentItem(o)},O.prototype._initCurrentItem=function(t){var e;null!==this.options.current&&void 0!==this.options.current&&("number"==typeof this.options.current?e=this.$items.eq(this.options.current):this.options.current instanceof HTMLElement?e=l(this.options.current):this.options.current.jquery&&(e=this.options.current)),e&&e.length&&-1!==this.$items.get().indexOf(e[0])||(e=this.options.mode===C.START?this.$items.first():this.options.mode===C.END?this.$items.last():this._findCenterItem(t)),this._setCurrent(e,!1,!1,!1,!0),this._$possibleCurrent=this.$currentItem,this._fixItemsPositions()},O.prototype._findCenterItem=function(t){var r=0,o=t/2,a=this;return this.$items.each(function(t,e){var i=T(e),s=i.data(E+a.NS),n=s+i.outerWidth();if(s<=o&&o<=n)return r=t,!1}),this.$items.eq(r)},O.prototype._initEvents=function(){1===k.length&&this._initGlobalEvents();var i=this;this.$self.on("mousedown"+this.NS+" touchstart"+this.NS,this._onPointerStart.bind(this)),this.$self.on("click"+this.NS,p.selector("item"),function(t){i._byMouse||i._byTouch||i.disabled||i._onPointerEnd(t),i._byMouse=!1,t.preventDefault()});var e=null;this.$self.on("keydown"+this.NS,function(t){i.disabled||e||-1===[37,38,39,40].indexOf(t.which)||(e=!0,setTimeout(function(){e=!1},i.options.keyThrottle),i._onKey(t))});var s=null;this.$self.on("mousewheel"+this.NS+" DOMMouseScroll"+this.NS,function(t){w&&!i.disabled&&(s?t.preventDefault():(s=!0,setTimeout(function(){s=!1},i.options.wheelThrottle),i._onWheel(t)))}),this.options.watchContainer&&(this._containerWatcher=setInterval(function(){var t=i._generateSelfRect(!0);t.width.toFixed(2)===i._selfRect.width.toFixed(2)&&t.height.toFixed(2)===i._selfRect.height.toFixed(2)||i.softRefresh()},this.options.watchContainer)),this.options.watchItems&&(this._itemsWatcher=setInterval(function(){for(var t=i.$items.get().map(function(t){return g(t)}),e=0;e<i._lastSizes.length;e++)if(t[e].width.toFixed(2)!==i._lastSizes[e].width.toFixed(2)||t[e].height.toFixed(2)!==i._lastSizes[e].height.toFixed(2))return void i.softRefresh()},this.options.watchItems))},O.prototype._initGlobalEvents=function(){var t=null,e=document.documentElement.clientHeight,i=document.documentElement.clientWidth;o.on("resize."+a,function(){i===document.documentElement.clientWidth&&e===document.documentElement.clientHeight||(clearTimeout(t),t=setTimeout(function(){k.forEach(function(t){t.softRefresh()})},50),e=document.documentElement.clientHeight,i=document.documentElement.clientWidth)}),o.on("touchmove."+a,function(t){$.length&&t.preventDefault()}),o.on("scroll."+a,function(t){t.target===document&&(w=!1,clearTimeout(y),y=setTimeout(function(){w=!0},O.CAPTURE_WHEEL_TIMEOUT))})},O.prototype._destroyEvents=function(){clearInterval(this._containerWatcher),clearInterval(this._itemsWatcher),this.$self.off(this.NS),o.on(this.NS),k.length||o.off("touchstart."+a).off("scroll."+a).off("resize."+a)},O.prototype._onPointerStart=function(t){if(this._byMouse=!!t.type.match(/mouse/),this.disabled||this._skipMouse&&this._byMouse)this._skipMouse=!1;else if(!1!==this._hasPointer||this._byMouse&&0!==t.button)t.preventDefault();else{if(this._byTouch=!this._byMouse,this._skipNonmove=!0,this._generateSelfRect(),this.$self.focus(),this._hasPointer=!0,this._pointerIndex=0,this._draggingPrevented=!1,$.push(this),this._byTouch&&(this._hasPointer=t.originalEvent.changedTouches[0].identifier,this._findTouchPointerIndex(t)),this._fixVertical=null,this._setPossibleCurrentItem(!1,!0,!0),this._lastClientY=r(t,"y",this._pointerIndex),this._lastClientX=r(t,"x",this._pointerIndex),this._trackMoved=!1,this._byMouse)return o.on("mousemove"+this.NS,this._onPointerMove.bind(this)).one("mouseup"+this.NS,this._onPointerEnd.bind(this)),void t.preventDefault();this.$self.on("touchmove"+this.NS,this._onPointerMove.bind(this)).one("touchend"+this.NS,this._onPointerEnd.bind(this)),this._skipMouse=!0}},O.prototype._onPointerMove=function(t){if(!1!==this._hasPointer){t.type.match(/touch/)&&this._findTouchPointerIndex(t);var e=r(t,"y",this._pointerIndex),i=r(t,"x",this._pointerIndex),s=i-this._lastClientX;if(s||!this._skipNonmove)if(this._skipNonmove=!1,null===this._fixVertical&&(this._clearTrackTransition(),this._fixVertical=!this._byMouse&&this._fixVertical),this._byTouch&&null===this._fixVertical&&1===t.originalEvent.touches.length&&(this._fixVertical=Math.abs(e-this._lastClientY)+1>Math.abs(s)),this._fixVertical)-1!==$.indexOf(this)&&$.splice($.indexOf(this),1);else{if(s){this._trackMoved||this.$track.addClass(p.dragging);var n=l.extend({},l.Event(),{type:O.EVENT.dragging,target:this.$self[0],originalEvent:t.originalEvent,infinitum:this});if(this.$self.trigger(n,this),n.isDefaultPrevented())return void(this._draggingPrevented=!0);this._forceCancelRAF=!this._trackMoved,this._move(s,!1,!1),this._lastTrackX=m(this.$track).x}this._lastDir=s?i>this._lastClientX?O.DIR.RIGHT:O.DIR.LEFT:this._lastDir,this._trackMoved=i!==this._lastClientX||this._trackMoved,this._lastClientX=i,this._lastClientY=e,t.preventDefault()}else this._skipNonmove=!1}else t.preventDefault()},O.prototype._isReverseDirection=function(){return this._lastDir===O.DIR.RIGHT&&(this.options.mode===C.START||this.options.mode===C.CENTER)||this._lastDir===O.DIR.LEFT&&this.options.mode===C.END},O.prototype._findTouchPointerIndex=function(t){for(var e in t.originalEvent.touches)if(t.originalEvent.touches.hasOwnProperty(e)&&t.originalEvent.touches[e].identifier===this._hasPointer){this._pointerIndex=e;break}},O.prototype._onPointerEnd=function(t){if(!(this._byMouse&&0!==t.button||!1===this._hasPointer&&"click"!==t.type)){if(this._hasPointer=!1,this._forceCancelRAF=!1,-1!==$.indexOf(this)&&$.splice($.indexOf(this),1),o.off("mousemove"+this.NS),this.$self.off("touchmove"+this.NS),!this._trackMoved&&null===this._fixVertical&&!this._draggingPrevented)return this._onTap(t);this._clearTrackTransition(),this._draggingPrevented=!1,this._setCurrent(this._findCurrentItem(),!1,!1,!0),this.$track.removeClass(p.dragging);var e=l.extend({},l.Event(),{type:O.EVENT.dragend,target:this.$self[0],originalEvent:t.originalEvent,infinitum:this});this.$self.trigger(e,this),this._trackMoved=!1,e.isDefaultPrevented()||t.preventDefault()}},O.prototype._onTap=function(t){var e=l(t.target).closest(p.selector("item"));if(e.length){if(this._triggerChangeTypeEvent(O.EVENT.tap,t,e).isDefaultPrevented())return;var i=g(this.$currentItem[0]).left,s=g(e[0]).left;this._lastDir=i===s?this.options.mode===C.END?O.DIR.RIGHT:O.DIR.LEFT:s<i?O.DIR.RIGHT:O.DIR.LEFT,this.$currentItem[0]===e[0]?this._setPossibleCurrentItem(!0):(this._clearTrackTransition(),this.options.wheelKeysTapSetCurrent?this._setCurrent(e,!1):this._moveToItem(e,!1))}else this._setPossibleCurrentItem(!0);return this._trackMoved=!1,!e.length},O.prototype._onWheel=function(t){if(!this.disabled){this._clearTrackTransition(),this._shouldCancelRAF=!0,this._lastDir=0<(t.originalEvent.detail||t.originalEvent.deltaY||t.originalEvent.deltaX||-t.originalEvent.wheelDelta)?O.DIR.LEFT:O.DIR.RIGHT;var e=this._lastDir===O.DIR.LEFT?this.findNext():this.findPrev();this._triggerChangeTypeEvent(O.EVENT.scroll,t,e).isDefaultPrevented()||(this._trackMoved=!0,this.$self.focus(),this._generateSelfRect(),this.options.wheelKeysTapSetCurrent?this._setCurrent(e,!1,!0):this._moveToItem(e,!0),t.preventDefault())}},O.prototype._onKey=function(t){if(!this.disabled){this._clearTrackTransition(),this._shouldCancelRAF=!0,this._lastDir=-1===[37,38].indexOf(t.which)?O.DIR.LEFT:O.DIR.RIGHT;var e=this._lastDir===O.DIR.LEFT?this.findNext():this.findPrev();this._triggerChangeTypeEvent(O.EVENT.key,t,e).isDefaultPrevented()||(this._trackMoved=!0,this._generateSelfRect(),this.options.wheelKeysTapSetCurrent?this._setCurrent(e,!1,!0):this._moveToItem(e,!0),t.preventDefault())}},O.prototype._triggerChangeTypeEvent=function(t,e,i,s){var n=l.extend({},l.Event(),{type:t,target:i[0],fromElement:this.$currentItem[0],toElement:i[0],originalEvent:e?e.originalEvent:null,infinitum:this},s||null);return this.$self.trigger(n,this),n},O.prototype._moveTrack=function(t,e,i){var s=m(this.$track).x+t;this._setTrackPosition(s,e,i),this._trackXShouldBe=s},O.prototype._setTrackPosition=function(t,e,i){var s=this;if(this._clearTrackTransition(),this.$track[0].style[u]=e?"":"none",e){this._shouldCancelRAF=!1,this._forceCancelRAF=!1;var n,r=this._setTrackSpeed(t,i),o=function(t){(!t||t.originalEvent.target===s.$track[0]&&t.originalEvent.propertyName.match(/transform/i))&&(s._clearTrackTransition(),s.$track[0].style[u+"Duration"]=e?"":"none",s._generateSelfRect(),s._shouldCancelRAF=!0)};this.$track.on(f+this.NS,o),n=setTimeout(o,r+50),this.$track.data(v+this.NS,n),f||this._animateTrackWithJQuery(t,r,o)}!f&&e||(this.$track[0].style[d]=c?"translate3d("+t+"px, 0px, 0px)":"translateX("+t+"px)"),this.$track.data(_+this.NS,t),e&&(this._lastRAF=requestAnimationFrame(this._animate))},O.prototype._animateTrackWithJQuery=function(i,t,e){var s=m(this.$track).x;this.$track.stop(!0).css({textIndent:0}).animate({textIndent:1},{duration:t,easing:"easeOutQuad."+a,step:function(t){var e={};e[d]="translateX("+(s+(i-s)*t)+"px)",this.$track.css(e)}.bind(this),complete:e})},O.prototype._clearTrackTransition=function(){clearTimeout(this.$track.data(v+this.NS)),this.$track.off(f+this.NS).data(v+this.NS,null)},O.prototype._getAvgSpeed=function(){return this._speed.reduce(function(t,e){return t+e},0)/this._speed.length},O.prototype._setTrackSpeed=function(t,e){var i=m(this.$track).x,s=Math.abs(i-t),n=100;if(e){var r=this._getAvgSpeed();n/=Math.max(1,Math.log(r/3)),n=2*Math.max(Math.min(n,150),50)}var o=(n*Math.max(1,Math.log(s/5))).toFixed();return o=Math.max(Math.min(o,650),150),this.$track[0].style[u+"Duration"]=o+"ms",o},O.prototype._setFadeSpeed=function(t,e){if(e){if(0===this._lastFadeSpeed)return;return this._lastFadeSpeed=0,void this.$track.removeClass(p.speed1).removeClass(p.speed2).removeClass(p.speed3).addClass(p.speed0)}t&&(this._speed=this._speed.slice(0,5),this._speed.unshift(Math.abs(t)));var i=this._getAvgSpeed();if(i<8){if(1===this._lastFadeSpeed)return;this._lastFadeSpeed=1,this.$track.removeClass(p.speed0).removeClass(p.speed2).removeClass(p.speed3).addClass(p.speed1)}else if(i<16){if(2===this._lastFadeSpeed)return;this._lastFadeSpeed=2,this.$track.removeClass(p.speed0).removeClass(p.speed1).removeClass(p.speed3).addClass(p.speed2)}else{if(3===this._lastFadeSpeed)return;this._lastFadeSpeed=3,this.$track.removeClass(p.speed0).removeClass(p.speed1).removeClass(p.speed2).addClass(p.speed3)}},O.prototype._move=function(t,e,i,s){clearTimeout(this._fixItemsPositionsTimeout),this.$track.addClass(p.moving),this._setFadeSpeed(t,i&&(!s||!this.initialized)),e||i||this._moveTrack(t),this._sortItems(e);var n=e&&this._shouldCancelRAF&&(!t||this._forceCancelRAF),r=n&&!this.$willStartItem.hasClass(p.current),o=n&&!this.$willEndItem.hasClass(p.current);this._moveItemsOverToTheOtherSide(t,n,r,o,i),i||this._setPossibleCurrentItem(n,t),e&&(!n||!(this.options.mode!==C.CENTER||!n||r&&o)&&this.options.balanced&&2<this.$items.length)?this._lastRAF=requestAnimationFrame(this._animate):n&&(i||!this.options.clearEdge&&this.options.mode!==C.CENTER||!r&&!o||this._fixItemsPositions(),this.$track.removeClass(p.moving))},O.prototype._moveItemsOverToTheOtherSide=function(t,e,i,s,n){this.options.mode===C.START?t<0||(i||n)&&this.options.clearEdge?this._moveLeftItemsOverToTheEnd(e,i,n):0<t&&this._moveRightItemsOverToTheStart(e):this.options.mode===C.END?0<t||(s||n)&&this.options.clearEdge?this._moveRightItemsOverToTheStart(e,s,n):t<0&&this._moveLeftItemsOverToTheEnd(e):t<0||!t&&!s?this._moveLeftItemsOverToTheEnd(e):(0<t||n||!t&&!i)&&this._moveRightItemsOverToTheStart(e)},O.prototype._fixItemsPositions=function(){clearTimeout(this._fixItemsPositionsTimeout);var i=this,s=!1;this.$items.each(function(t,e){if(T(e).data(v+i.NS))return i._fixItemsPositionsTimeout=setTimeout(i._fixItemsPositions.bind(i),0),!1;s=t===i.$items.length-1}),s&&(this._forceCancelRAF=!0,this._fakeMove(!0))},O.prototype._fakeMove=function(t){if(this.options.mode===C.CENTER)return this._move(1,!1,!0),void this._move(-1,!1,!0);this._move(this._lastDir===O.DIR.LEFT?-1:1,!0,!0,t)},O.prototype._sortItems=function(t){var e=this._getItemsData(t);this.startItemPosWill=e.startPosWill,this.endItemPosWill=e.endPosWill,this.endItemWidthWill=e.endWidthWill,this.$insideItems=l(e.inside),this.$willStartItem=this.$willStartItem&&this.$willStartItem[0]===e.willStart?this.$willStartItem:l(e.willStart),this.$willEndItem=this.$willEndItem&&this.$willEndItem[0]===e.willEnd?this.$willEndItem:l(e.willEnd),this._setItemsOverInCorrectOrder(e),this._setItemOverIfNotBreakOnEdge(e)},O.prototype._setItemsOverInCorrectOrder=function(t){1<t.leftOver.length?this.$leftItemsOver=l(t.leftOver.sort(function(t,e){return t.getBoundingClientRect().left-e.getBoundingClientRect().left})):this.$leftItemsOver=l(t.leftOver),1<t.rightOver.length?this.$rightItemsOver=l(t.rightOver.sort(function(t,e){return e.getBoundingClientRect().left-t.getBoundingClientRect().left})):this.$rightItemsOver=l(t.rightOver)},O.prototype._setItemOverIfNotBreakOnEdge=function(t){if(1!==this.$items.length||this.options.mode!==C.CENTER)if(this.options.mode===C.START||this.options.mode===C.CENTER&&this._isReverseDirection()){if(!this.options.breakOnEdge&&!this.$leftItemsOver.length&&!this.$rightItemsOver.length&&t.willStartRect.left>this._selfRect.left){if(this.options.balanced)return void(Math.abs(-this._selfRect.center+(t.willStartRect.left-t.willEndRect.width))<=Math.abs(-this._selfRect.center+t.willEndRect.right)&&(this.$rightItemsOver=this.$willEndItem));this.$rightItemsOver=this.$willEndItem}}else if(this.options.mode===C.END||this.options.mode===C.CENTER&&!this._isReverseDirection()){if(!this.options.breakOnEdge&&!this.$leftItemsOver.length&&!this.$rightItemsOver.length&&t.willEndRect.right<this._selfRect.right){if(this.options.balanced){var e=Math.abs(-this._selfRect.center+t.willStartRect.left);return void(Math.abs(-this._selfRect.center+(t.willEndRect.right+t.willEndRect.width))<=e&&(this.$leftItemsOver=this.$willStartItem))}this.$leftItemsOver=this.$willStartItem}}else;},O.prototype._getItemsData=function(o){var a=this,h=[],l=[],d=[],c=null,u=null,f=null,m=null,p=null,_=null,v=null;return this.$items.each(function(t,e){var i=T(e),s=g(e),n=i.data(E+a.NS)-(i.data(I+a.NS)+i.data(S+a.NS));if((null===p||p>s.left+n)&&(p=s.left+n,c=e,f={left:s.left+n,right:s.right+n,width:s.width}),(null===_||_<s.right+n)&&(_=s.right+n,v=s.width,u=e,m={left:s.left+n,right:s.right+n,width:s.width}),o&&e===a._$possibleCurrent[0])d.push(e);else if(a.options.mode!==C.CENTER||!a.options.balanced||a.options.breakOnEdge){var r=a._getBreakEdge(s);r.left<a._selfRect.left?h.push(e):r.right>a._selfRect.right?l.push(e):d.push(e)}else s.left+n<=a._selfRect.center&&s.right+n>=a._selfRect.center?d.push(e):s.left+n<=a._selfRect.center?h.push(e):l.push(e)}),{leftOver:h,rightOver:l,inside:d,willStart:c,willEnd:u,willStartRect:f,willEndRect:m,startPosWill:p,endPosWill:_,endWidthWill:v}},O.prototype._getBreakEdge=function(t){var e=t.left,i=t.right-1;switch(this.options.startBreak){case O.POSITION.CENTER:e=t.left+t.width/2;break;case O.POSITION.END:e=t.right-1}switch(this.options.endBreak){case O.POSITION.START:i=t.left;break;case O.POSITION.CENTER:i=t.right-1-t.width/2}return{left:e,right:i}},O.prototype._moveLeftItemsOverToTheEnd=function(i,s,n){var r=this,o=[],a=0;this.$leftItemsOver.each(function(){var t=T(this),e=t.outerWidth();if(!r.options.balanced||r.options!==C.CENTER&&i&&n&&r.options.clearEdge){if(r.options.mode===C.START||r.options.mode===C.CENTER){if(!r.options.breakAll&&!r.options.clearEdge&&r.endItemPosWill+a>=r._selfRect.right)return}else if(r.options.mode===C.END&&!r.options.breakAll&&r.endItemPosWill+a+.5>=r._selfRect.right)return}else if(Math.abs(-r._selfRect.center+(r.startItemPosWill+a))<=Math.abs(-r._selfRect.center+(r.endItemPosWill+a+e)))return!1;r.options.clearEdge&&s&&(t.hasClass(p.current)||!r.options.clearEdge&&!n)||(!t.hasClass(p.hide)||t.hasClass(p.toStart)||r.options.clearEdge&&s||n)&&(a+=e,o.push(l(this)))}),o.forEach(function(t){r._breakItem(t,C.END)}),i&&this._clearHideStates(C.START)},O.prototype._moveRightItemsOverToTheStart=function(s,n,r){var o=this,a=[],h=0;this.$rightItemsOver.each(function(){var t=T(this),e=t.outerWidth();if(!o.options.balanced||o.options!==C.CENTER&&s&&r&&o.options.clearEdge){if(o.options.mode===C.START||o.options.mode===C.CENTER){if(!o.options.breakAll&&o.startItemPosWill-h-.5<=o._selfRect.left)return}else if(o.options.mode===C.END&&!o.options.breakAll&&!o.options.clearEdge&&o.startItemPosWill-h<=o._selfRect.left)return}else{var i=Math.abs(-o._selfRect.center+(o.startItemPosWill-h-e));if(Math.abs(-o._selfRect.center+(o.endItemPosWill-h))<=i)return!1}o.options.clearEdge&&n&&(t.hasClass(p.current)||!o.options.clearEdge&&!r)||(!t.hasClass(p.hide)||t.hasClass(p.toEnd)||o.options.clearEdge&&n||r)&&(h+=e,a.push(l(this)))}),a.forEach(function(t){o._breakItem(t,C.START)}),s&&this._clearHideStates(C.END)},O.prototype._breakItem=function(n,r){var o=this;n.off(f+this.NS),clearTimeout(n.data(v+this.NS));var t=r===C.START?this.findNext(n):this.findPrev(n),e=r===C.START?n.outerWidth():-t.outerWidth(),i=t.data(E+this.NS)-e;if(this.options.fade){var s=getComputedStyle(n[0]).opacity;n.addClass(r===C.START?p.toStart:p.toEnd).removeClass(r===C.START?p.toEnd:p.toStart).removeClass(p.hide),n.data(E+this.NS,i);var a,h=r===C.END&&this.options.fade===C.END||r===C.START&&this.options.fade===C.START,l=function(t){if(!t||t.originalEvent.target===n[0]||"opacity"===t.originalEvent.propertyName){clearTimeout(a);var e={},i={},s=n.data(E+o.NS)-n.data(S+o.NS);e[d]=c?"translate3d("+s+"px, 0px, 0px)":"translateX("+s+"px)",e[u]=h||!0===o.options.fade?"":"none",i[I+o.NS]=s,i[v+o.NS]=null,n.data(i).css(e),n.removeClass(p.hide).removeClass(r===C.START?p.toStart:p.toEnd),n.off(f+o.NS)}};h?(n.css(u,"none").addClass(p.hide),a=setTimeout(l,0),n.data(v+this.NS,a)):parseFloat(s)?(a=setTimeout(l,O.FAKE_TRANSITION_TIMEOUT),n.data(v+this.NS,a),n.on(f+this.NS,l),n.css(u,""),n.addClass(p.hide)):l()}else this._breakItemNoFade(n,i)},O.prototype._breakItemNoFade=function(t,e){var i={},s={},n=e-t.data(S+this.NS);i[d]=c?"translate3d("+n+"px, 0px, 0px)":"translateX("+n+"px)",i[u]="",s[I+this.NS]=n,s[E+this.NS]=e,t.css(i).data(s)},O.prototype._clearHideStates=function(i){if(this.options.fade){var s=this;(i===C.END?this.$rightItemsOver:this.$leftItemsOver).each(function(){var t=T(this),e={};(i===C.END?t.hasClass(p.toStart):t.hasClass(p.toEnd))||(t.off(f+s.NS),clearTimeout(t.data(v+s.NS)),t.removeClass(p.hide).removeClass(i===C.END?p.toEnd:p.toStart),e[v+s.NS]=null,e[E+s.NS]=t.data(I+s.NS)+t.data(S+s.NS),t.data(e))})}},O.prototype._animate=function(){this._move(m(this.$track).x-this._lastTrackX,!0),this._lastTrackX=m(this.$track).x},O.prototype._setCurrent=function(t,e,i,s,n){if(t&&t[0]){if(t[0]!==this.$currentItem[0]){if(this._triggerChangeTypeEvent(O.EVENT.change,null,t).isDefaultPrevented())return void(e||this._moveToItem(this.$currentItem,i,s,n));this.$currentItem.removeClass(p.current),(this.$currentItem=t).addClass(p.current)}e||this._moveToItem(t,i,s,n)}},O.prototype._moveToItem=function(t,e,i,s){switch(this.options.mode){case C.START:return this._moveToItemModeStart(t,e,i,s);case C.END:return this._moveToItemModeEnd(t,e,i,s);case C.CENTER:return this._moveToItemModeCenter(t,e,i,s)}},O.prototype._moveToItemModeCenter=function(t,e,i,s){var n,r=t.data(E+this.NS),o=t.data(I+this.NS)+t.data(S+this.NS),a=g(t[0]);if(s&&(this._shouldCancelRAF=!0,this._forceCancelRAF=!0),e){if(1===this.$items.length)return;if(n=this.$track.data(_+this.NS),this._isReverseDirection()){var h=this.findNext(t).outerWidth();return void this._setTrackPosition(n+a.width/2+h/2,!s,i)}var l=this.findPrev(t).outerWidth();this._setTrackPosition(n-a.width/2-l/2,!s,i)}else{var d=a.left+(r-o)-this._selfRect.left-(this._selfRect.right-this._selfRect.left)/2+a.width/2;(d||this._trackXShouldBe!==m(this.$track).x)&&this._moveTrack(-d,!s,i)}},O.prototype._moveToItemModeEnd=function(t,e,i,s){var n,r=t.data(E+this.NS),o=t.data(I+this.NS)+t.data(S+this.NS),a=g(t[0]);if(s&&(this._shouldCancelRAF=!0,this._forceCancelRAF=!0),e){if(1===this.$items.length)return;if(n=this.$track.data(_+this.NS),this._isReverseDirection())return void this._setTrackPosition(n-a.width,!s,i);var h=this.findNext(t).outerWidth();this._setTrackPosition(n+h,!s,i)}else{var l=a.right+(r-o)-this._selfRect.right;if(l||this._trackXShouldBe!==m(this.$track).x)this._moveTrack(-l,!s,i);else this.$willEndItem.length&&!this.$willEndItem.hasClass(p.current)&&this._fixItemsPositions()}},O.prototype._moveToItemModeStart=function(t,e,i,s){var n,r=t.data(E+this.NS),o=t.data(I+this.NS)+t.data(S+this.NS),a=g(t[0]);if(s&&(this._shouldCancelRAF=!0,this._forceCancelRAF=!0),e){if(1===this.$items.length)return;if(n=this.$track.data(_+this.NS),this._isReverseDirection())return void this._setTrackPosition(n+a.width,!s,i);var h=this.findPrev(t).outerWidth();this._setTrackPosition(n-h,!s,i)}else{var l=a.left+(r-o)-this._selfRect.left;if(l||this._trackXShouldBe!==m(this.$track).x)this._moveTrack(-l,!s,i);else this.$willStartItem.length&&!this.$willStartItem.hasClass(p.current)&&this._fixItemsPositions()}},O.prototype._setPossibleCurrentItem=function(t,e,i){if(e){var s=this._findCurrentItem(),n=s[0]!==this._$possibleCurrent[0];(n||i)&&(s.addClass(p.possibleCurrent),n&&(this._$possibleCurrent.removeClass(p.possibleCurrent),this._triggerChangeTypeEvent(O.EVENT.possibleChange,null,s),this._$possibleCurrent=s))}if(t)return this._$possibleCurrent.removeClass(p.possibleCurrent),void(e&&this._setCurrent(this._$possibleCurrent))},O.prototype._findCurrentItem=function(){return this._findClosestItem(this._isReverseDirection()?"out":"in")},O.prototype._findClosestItem=function(d){var c,u=this,f=null,m="in"===d?"currentIn":"currentOut";return this.$items.each(function(t,e){var i,s,n=T(e),r=n.data(E+u.NS),o=n.data(I+u.NS)+n.data(S+u.NS),a=g(e),h=a.left+(r-o),l=a.right+(r-o);if(u.options.mode===C.CENTER&&u.options[m]!==R.CLOSEST)return u._isCenter(h,l)?(c=e,!1):void 0;s=u.options.mode===C.CENTER&&u.options[m]===R.CLOSEST?(i=h-u._selfRect.center+1,l-u._selfRect.center-1):(i=h-u._selfRect[u.options.mode===C.END?"right":"left"],l-u._selfRect[u.options.mode===C.END?"right":"left"]),u._isCloser(d,f,i,s)&&(f=u.options.mode===C.CENTER&&u.options[m]===R.CLOSEST?"in"===d?i:s:u.options.mode===C.END?s:i,c=e)}),l(c)},O.prototype._isCenter=function(t,e){return t<=this._selfRect.center&&e>=this._selfRect.center},O.prototype._isCloser=function(t,e,i,s){var n="in"===t?"currentIn":"currentOut";if(this.options.mode===C.START)switch(this.options[n]){case R.CLOSEST:return null===e||Math.abs(i)<Math.abs(e);case R.FULL:return 0<=i&&(null===e||Math.abs(i)<Math.abs(e));case R.STILL_INSIDE:return.5<=s&&(null===e||i<e)}else{if(this.options.mode!==C.END){if(this.options[n]===R.CLOSEST)switch(t){case"in":return null===e||Math.abs(i)<Math.abs(e);case"out":return null===e||Math.abs(s)<Math.abs(e)}return null===e||Math.abs(i)<Math.abs(e)}switch(this.options[n]){case R.CLOSEST:return null===e||Math.abs(s)<Math.abs(e);case R.FULL:return s<=0&&(null===e||Math.abs(s)<Math.abs(e));case R.STILL_INSIDE:return i<=-.5&&(null===e||e<s)}}}}(jQuery);
